# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é CRM‚Äë–±–æ—Ç–æ–º –∏ Supabase

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CRM‚Äë–±–æ—Ç–∞ –∏ –±–∞–∑—É
–¥–∞–Ω–Ω—ã—Ö Supabase –≤ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ. –û–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–∞–≤–ª—è—é—Ç —Å–∏—Å—Ç–µ–º–æ–π –∑–∞–¥–∞—á –∏ —Ä–æ–ª–µ–π.

## 1. –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è

CRM‚Äë–±–æ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö Supabase –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä—è–º–æ –≤ Telegram. –î–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö,
–ø—Ä–æ—Ñ–∏–ª—è—Ö, –∑–∞–¥–∞—á–∞—Ö –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö Supabase. –í–µ–±‚Äë–ø–∞–Ω–µ–ª—å
(`crm_app`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–ª—É–∂–∏—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è
–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏. –ë–ª–∞–≥–æ–¥–∞—Ä—è –æ–±—â–µ–º—É –±–µ–∫–µ–Ω–¥—É –≤—ã –º–æ–∂–µ—Ç–µ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –±–æ—Ç, –∏ –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ: –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ
–æ–¥–Ω–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –±—É–¥—É—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–∏–¥–Ω—ã –≤ –¥—Ä—É–≥–æ–º.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

* **users** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. –ü–æ–ª—è:
  `id` (uuid), `telegram_id`, `username`, `first_name`, `last_name`,
  `created_at`.
* **profiles** ‚Äî –ø—Ä–æ—Ñ–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –°–≤—è–∑–∞–Ω—ã —Å —Ç–∞–±–ª–∏—Ü–µ–π Supabase
  `auth.users` –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤. –ü–æ–ª—è: `id`
  (uuid –∏–∑ `auth.users`), `full_name`, `telegram_id`, `role` (—Å—Ç—Ä–æ–∫–∞
  `project_head`, `team_leader`, `region_manager` –∏–ª–∏ `junior_manager`).
* **tasks** ‚Äî –∑–∞–¥–∞—á–∏ CRM. –°–æ–¥–µ—Ä–∂–∏—Ç `title`, `client`, `due_date`,
  `description`, `status`, `result`, `assigner_telegram_id`,
  `assignee_telegram_id`, `comments`, `created_at`, `updated_at`.
* **task_files** ‚Äî –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∫ –∑–∞–¥–∞—á–∞–º. –ü–æ–ª—è: `id`, `task_id`,
  `file_url`, `created_at`.

–î—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `leads` –∏ `messages`, –æ–±—Å–ª—É–∂–∏–≤–∞—é—Ç —Å–±–æ—Ä –ª–∏–¥–æ–≤
–∏ –∂—É—Ä–Ω–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∑–∞–¥–∞—á.

## 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞–º–∏ –∏ —Ä–æ–ª—è–º–∏

–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∑–∞–¥–∞—á–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–µ–º `role` –≤
—Ç–∞–±–ª–∏—Ü–µ `profiles`. –ü—Ä–∏–Ω—è—Ç–∞ —Å–ª–µ–¥—É—é—â–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–ª–µ–π (–æ—Ç –≤—ã—Å–æ–∫–æ–≥–æ
–∫ –Ω–∏–∑–∫–æ–º—É):

| –†–æ–ª—å            | –ú–æ–∂–µ—Ç —Å—Ç–∞–≤–∏—Ç—å –∑–∞–¥–∞—á–∏ | –ö–æ–º—É —Å—Ç–∞–≤–∏—Ç           | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç    | –í–∏–¥–∏—Ç –∑–∞–¥–∞—á–∏                       |
|-----------------|----------------------|-----------------------|---------------------------|------------------------------------|
| `project_head`  | –í—Å–µ–º                 | `team_leader`         | `team_leader`             | –í—Å–µ –∑–∞–¥–∞—á–∏                        |
| `team_leader`   | –°–µ–±–µ –∏ —Ä–µ–≥–∏–æ–Ω–∞–ª–∞–º    | `region_manager`      | `region_manager`          | –°–≤–æ–∏ –∏ –∑–∞–¥–∞—á–∏ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö         |
| `region_manager`| –°–µ–±–µ –∏ –º–ª–∞–¥—à–∏–º       | `junior_manager`      | `junior_manager`          | –°–≤–æ–∏ –∏ –∑–∞–¥–∞—á–∏ –º–ª–∞–¥—à–∏—Ö             |
| `junior_manager`| –¢–æ–ª—å–∫–æ —Å–µ–±–µ          | ‚Äî                     | ‚Äî                         | –¢–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏                |

### –ö–∞–∫ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase Auth. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
   –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é magic‚Äëlink (—Å–º. `crm_app/src/Tasks.jsx`) –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å
   –∑–∞–ø–∏—Å—å –≤—Ä—É—á–Ω—É—é.
2. –í —Ç–∞–±–ª–∏—Ü–µ `profiles` –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É:

   - `id` ‚Äî UUID –∏–∑ `auth.users` (–≤ Supabase Auth).
   - `full_name` ‚Äî –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–æ—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞
     –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π).
   - `telegram_id` ‚Äî —á–∏—Å–ª–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä Telegram (–∫–æ–≥–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫
     –∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞, `telegram_id` –±—É–¥–µ—Ç –∏–∑–≤–µ—Å—Ç–µ–Ω).
   - `role` ‚Äî –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π (`project_head`, `team_leader`,
     `region_manager`, `junior_manager`).

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ (–∏–ª–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º
–æ–±—Ä–∞—â–µ–Ω–∏–∏), —Ä–æ–ª—å –±—É–¥–µ—Ç —É—á—Ç–µ–Ω–∞.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–æ–º–µ–Ω—É

–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–æ—á—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä –Ω–∞ —Ç–∞–±–ª–∏—Ü—É
`auth.users`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ–º–µ–Ω email –∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏
email –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `@sds-group.ru`. –ü—Ä–∏–º–µ—Ä –∏–∑ –ø–ª–∞–Ω–æ–≤
—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

```sql
CREATE OR REPLACE FUNCTION check_email_domain()
RETURNS TRIGGER AS $$
BEGIN
  IF NEW.email NOT LIKE '%@sds-group.ru' THEN
    RAISE EXCEPTION 'INCORRECT_DOMAIN';
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER auth_users_email_check
BEFORE INSERT ON auth.users
FOR EACH ROW EXECUTE FUNCTION check_email_domain();
```

–¢–µ–ø–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Magic Link –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è
–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤.

## 3. –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏ —á–µ—Ä–µ–∑ –±–æ—Ç

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤—Ä—É—á–Ω—É—é. –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π
–≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É `/start`. –û–Ω –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–∞—Å –≤ —Ç–∞–±–ª–∏—Ü–µ `users` –∏
   –ø–æ–∫–∞–∂–µ—Ç **–≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é**: –∫–Ω–æ–ø–∫–∏ ¬´üìã¬†–ú–æ–∏ –∑–∞–¥–∞—á–∏¬ª –∏ ¬´‚ûï¬†–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞¬ª.

2. –ù–∞–∂–º–∏—Ç–µ **¬´–ú–æ–∏ –∑–∞–¥–∞—á–∏¬ª**:
   - –ë–æ—Ç –≤—ã–≤–µ–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —è–≤–ª—è–µ—Ç–µ—Å—å –ø–æ—Å—Ç–∞–Ω–æ–≤—â–∏–∫–æ–º –∏–ª–∏
     –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º. –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π.
   - –í–Ω–∏–∑—É –±—É–¥—É—Ç –∫–Ω–æ–ø–∫–∏ ¬´‚ûï¬†–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É¬ª –∏ ¬´‚¨ÖÔ∏è¬†–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é¬ª.
   - –ù–∞–∂–∞–≤ –Ω–∞ –∑–∞–¥–∞—á—É, –≤—ã –ø–µ—Ä–µ–π–¥—ë—Ç–µ –≤ —Ä–µ–∂–∏–º –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

3. –ù–∞–∂–º–∏—Ç–µ **¬´–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É¬ª** –∏–ª–∏ **¬´–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞¬ª** –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é:
   - –ë–æ—Ç –ø–æ—à–∞–≥–æ–≤–æ —Å–ø—Ä–æ—Å–∏—Ç:
     1. *–ù–∞–∑–≤–∞–Ω–∏–µ* ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏.
     2. *–ö–ª–∏–µ–Ω—Ç* ‚Äî –∏–º—è –∏–ª–∏ ID –∫–ª–∏–µ–Ω—Ç–∞; –æ—Ç–ø—Ä–∞–≤—å—Ç–µ ¬´‚Äì¬ª, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ.
     3. *–î–µ–¥–ª–∞–π–Ω* ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD HH:MM`.
     4. *–û–ø–∏—Å–∞–Ω–∏–µ* ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏.
   - –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—Å—Ç–∞—ë—Ç—Å—è –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏
     –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–¥–∞—á–∞–º –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.
   - –ü–æ—Å–ª–µ –≤–≤–æ–¥–∞ –æ–ø–∏—Å–∞–Ω–∏—è –±–æ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è. –°–ø–∏—Å–æ–∫
     –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–π —Ä–æ–ª–∏ (—Å–º. —Ç–∞–±–ª–∏—Ü—É —Ä–æ–ª–µ–π
     –≤—ã—à–µ). –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–Ω–∞—á–∏—Ç—å —Å–µ–±–µ¬ª –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–≥–¥–∞.
   - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ –ø–æ–ª–Ω–æ–º—É –∏–º–µ–Ω–∏ (–∏–∑ `profiles.full_name`).
     –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –≤–≤–µ—Å—Ç–∏ Telegram‚ÄëID –∏–ª–∏ –ø–æ–ª–Ω–æ–µ –∏–º—è, –µ—Å–ª–∏
     –æ–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ –≤ –±–∞–∑–µ.
   - –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º
     **¬´–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è¬ª** –∏ –±–æ—Ç –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´–ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ
     –¥–æ–±–∞–≤–ª–µ–Ω–∞.¬ª —Å –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é.

4. **–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.** –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∑–∞–¥–∞—á–∏ –±–æ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤
   —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –í—ã –º–æ–∂–µ—Ç–µ:
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç (–∫—Ä–∞—Ç–∫–∏–π –æ—Ç—á—ë—Ç –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π);
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª (–¥–æ–∫—É–º–µ–Ω—Ç –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ). –ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç
     –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–∞–π–ª–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ `task_files`;
   - –ù–∞–∂–∞—Ç—å ¬´‚ùå¬†–û—Ç–º–µ–Ω–∞¬ª ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞—á, –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—è
     —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
   –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞
   **¬´–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏¬ª**, –∞ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –∑–∞–¥–∞—á—É –Ω–∞
   –ø—Ä–æ–≤–µ—Ä–∫—É (–ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ).

5. **–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á.** –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ (team_leader,
   project_head) –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö. –§—É–Ω–∫—Ü–∏–∏
   —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ ¬´–ó–∞–≤–µ—Ä—à–µ–Ω–æ (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ)¬ª
   –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∫–Ω–æ–ø–∫–∏. –í —Ç–µ–∫—É—â–µ–π
   –≤–µ—Ä—Å–∏–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω—É–∂–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ
   `tasks` —á–µ—Ä–µ–∑ Supabase –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å.

## 4. –†–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–∞–º–∏ —á–µ—Ä–µ–∑ –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å

–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/tasks` –≤ `crm_app` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è
—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Supabase Auth, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –≤—Ö–æ–¥–∞
–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ—á—Ç–∞ `@sds-group.ru`. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã:

* **–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á** ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ ¬´–ù–∞–∑–≤–∞–Ω–∏–µ¬ª, ¬´–ö–ª–∏–µ–Ω—Ç¬ª,
  ¬´–°—Ä–æ–∫¬ª, ¬´–°—Ç–∞—Ç—É—Å¬ª, ¬´–ü–æ—Å—Ç–∞–Ω–æ–≤—â–∏–∫¬ª –∏ ¬´–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å¬ª. –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–µ–π —Ä–æ–ª—å—é. `project_head` –≤–∏–¥–∏—Ç –≤—Å–µ
  –∑–∞–ø–∏—Å–∏, `team_leader` ‚Äî —Å–≤–æ–∏ –∏ –∑–∞–¥–∞—á–∏ –ø–æ–¥—á–∏–Ω—ë–Ω–Ω—ã—Ö, –∏ —Ç.–¥.
* **–§–∏–ª—å—Ç—Ä—ã** ‚Äî –ø–æ–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∫–ª–∏–µ–Ω—Ç—É –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –¥–∞—Ç.
* **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞—á.
* **–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞** ‚Äî —Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏. –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ
  –≤—ã–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `profiles`).
  –î–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π –¥–æ—Å—Ç—É–ø–Ω—ã —Ä–∞–∑–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏–¥–µ—Ä
  –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∑–∞–¥–∞—á—É —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º, –Ω–æ –Ω–µ
  –º–ª–∞–¥—à–∏–º). –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É `tasks`.

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å—ã, –¥–µ–¥–ª–∞–π–Ω—ã –∏ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è –ø—Ä—è–º–æ –≤
Supabase (—á–µ—Ä–µ–∑ SQL Editor –∏–ª–∏ Data¬†Browser) –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç—É
—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –º–æ–∂–µ—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
¬´–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å¬ª –Ω–∞–ø—Ä–æ—Ç–∏–≤ –∑–∞–¥–∞—á —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞
¬´–ó–∞–≤–µ—Ä—à–µ–Ω–æ (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ)¬ª.

## 5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á

–í —Ç–∞–±–ª–∏—Ü–µ `tasks` –ø–æ–ª–µ `status` —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á–∏. –í
–ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:

* **–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** ‚Äî –∑–∞–¥–∞—á–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –µ—â—ë –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω.
* **–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏** ‚Äî –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ø—Ä–∏–∫—Ä–µ–ø–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∑–∞–¥–∞—á–∞
  –æ–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º.
* **–ó–∞–≤–µ—Ä—à–µ–Ω–æ (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ)** ‚Äî —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ–¥–æ–±—Ä–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
* **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–∞** ‚Äî –¥–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à—ë–ª, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–µ—Ç. –≠—Ç–æ—Ç —Å—Ç–∞—Ç—É—Å –º–æ–∂–µ—Ç
  –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Supabase –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é
  (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´–†–∞—Å—Å—ã–ª–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π¬ª –≤ `README.md`).

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á:

* **–ß–µ—Ä–µ–∑ –±–æ—Ç:** —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∫–Ω–æ–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä,
  `/approvetask` –∏–ª–∏ –∫–Ω–æ–ø–∫—É ¬´‚úÖ¬†–ü—Ä–∏–Ω—è—Ç—å¬ª) –∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–æ–ª–µ `status` –≤
  –±–∞–∑–µ. –¢–µ–∫—É—â–∏–π –∫–æ–¥ –±–æ—Ç–∞ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ ¬´–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞
  —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏¬ª –ø–æ—Å–ª–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.
* **–ß–µ—Ä–µ–∑ –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å:** —Ä–∞—Å—à–∏—Ä—å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/tasks`, –¥–æ–±–∞–≤–∏–≤ –∫–Ω–æ–ø–∫—É
  ¬´–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å¬ª –¥–ª—è –∑–∞–¥–∞—á —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ
  `update` —Ç–∞–±–ª–∏—Ü—ã `tasks` –≤ Supabase.
* **–ß–µ—Ä–µ–∑ Supabase GUI:** –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `tasks` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å ‚Üí
  –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ–ª–µ `status` –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ.

## 6. –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

* **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ñ–∞–π–ª—ã**: –≤–º–µ—Å—Ç–æ –≤–ª–æ–∂–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ `tasks.result` –º–æ–∂–Ω–æ
  –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª –≤ [Supabase Storage](https://supabase.com/docs/guides/storage),
  –ø–æ–ª—É—á–∞—è URL –∏ –∑–∞–ø–∏—Å—ã–≤–∞—è –µ–≥–æ –≤ `task_files.file_url`.
* **–õ–æ–≥–∏**: –±–æ—Ç –ª–æ–≥–∏—Ä—É–µ—Ç –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (`logging.info`). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ
  `journalctl` (Linux) –∏–ª–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
* **RLS**: –≤–∫–ª—é—á–∞–π—Ç–µ Row Level Security –∏ –ø–∏—à–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π
  —Ç–∞–±–ª–∏—Ü—ã. –ü—Ä–∏–º–µ—Ä: —Ä–∞–∑—Ä–µ—à–∏—Ç—å `SELECT` –Ω–∞ `tasks` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏
  `assigner_telegram_id = current_user_id OR assignee_telegram_id = current_user_id`.
* **–ü—Ä–æ–µ–∫—Ç—ã Supabase**: –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `anon` –∫–ª—é—á, –∞ –¥–ª—è
  –±–æ—Ç–∞ ‚Äî `service_role`. –ù–µ —Ä–∞–∑–º–µ—â–∞–π—Ç–µ `service_role` –∫–ª—é—á –≤
  –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

---

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏
—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è CRM‚Äë–±–æ—Ç–æ–º –∏ Supabase. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã –º–æ–∂–µ—Ç–µ
—Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–æ–ª–∏, –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã, –æ—Ç—á—ë—Ç—ã,
—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –≤—Å—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑
–±–æ—Ç –∏–ª–∏ –≤–µ–±‚Äë–ø–∞–Ω–µ–ª—å, –∞ Supabase —Å–ª—É–∂–∏—Ç –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã.